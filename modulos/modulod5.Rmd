---
title:  "Probabilidades y Distribuciones Discretas"  
output:
  html_document:
    css: !expr here::here("styles/styles.css")
    toc: true
    toc_depth:  3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options("yaml.eval.expr" = TRUE)
```

# 1.5.Probabilidades y Distribuciones Discretas  
Todo lo biológico es incierto, pero podemos conocer algo de esa incertidumbre mediante el estudio de las __probabilidades__.

## 1.5.1.Probabilidades
#### Objetivo  
__Conocer las reglas básicas de las probabilidades__  
__Probabilidad__ es la medida de la oportunidad de que ocurra un evento, y puede variar entre 0 y 1.  Cuando la probabilidad es 0, el evento no es posible.  Cuando la probabilidad es 1, el evento es totalmente posible.  En el campo de la biología, las probabilidades varían entre esos dos extremos teóricos.  

### Probabilidad clásica y empírica  
Hay dos maneras básicas de determinar la probabilidad de que ocurra un evento.  

La __probabilidad clásica__, se basa en consideraciones teóricas.  Por ejemplo, un dado tiene seis caras (es un cubo), cada una con un número de puntos del 1 al 6; por lo tanto, la probabilidad de que ocurre un evento en particular, digamos que salgan en la parte superior 3 puntos, se puede calcular sin lanzar el dado, simplemente calculando la proporción: ocurrencias del evento esperado (3 puntos) dividido entre el número de eventos posibles (seis):
$$p = \frac{1}{6} \approx 0.1667$$
Otros ejemplos son las fichas de dominó, las caras de una moneda, las cartas de un juego de baraja.  

#### __Ejercicio__  
Calcule la probabilidad de tomar una ficha específica de dominó.  

Otra manera de determinar la probabilidad de un evento, está basada en la frecuencia relativa del evento en la población (o la muestra, generalmente) de interés.  A esta frecuencia relativa (o proporción del evento) se la conoce como __probabilidad empírica__. Por ejemplo, la probabilidad de ocurrencia en una problación de alguna condición genética, se determina de manera empírica según las evaluaciones médicas, como el número de casos (eventos) por nacimientos, aunque no conozcamos el mecanismo u origen de la condición.  

#### __Ejercicio__  
¿Cuál es la probabilidad de ocurrencia de gemelos en la población de Puerto Rico?

### La 'Regla de la División'    
Los cálculos de probabilidades en los ejemplos anteriores, siguen la denominada Regla de la División: la probabilidad de un evento _(p)_ es el número de veces en las que el evento puede ocurrir _(s)_ dividido por el número total de eventos posibles _(n)_, asumiendo que todos los eventos individuales son igualmente probables.  
$$p = \frac{s}{n}$$

### La Ley de la Probabilidad Total  
En algunos casos es difícil calcular la probabilidad de un evento en particular, no así las probabilidades de los otros eventos que no son el que nos interesa.  En este caso se puede aplicar la __ley de la probabilidad total__ que establece que la suma de las probabilidades de todos los eventos posibles es igual a 1.  Por lo tanto si conocemos las probabilidades de todos los eventos que no son el que nos interesa, podemos aplicar la __regla de substracción__:  
$$p = 1 - q$$  
dónde _(p)_ es la probabilidad del evento que nos interesa, y _(q)_ la probabilidad de todos los otros eventos posibles.    

### Distribución de probabilidades  
Una manera práctica de presentar las probabilidades de varios eventos, en grupos o poblaciones diversas, es mediante una lista de las probabilidades en forma de tabla o gráfica.  

#### __Ejemplo__    

```{r abo, message=FALSE, warning=FALSE}
library(readxl)
library(kableExtra)
# datos ABO grupos étnicos
abo <- read_excel("data/ABOtypes-ethnic-groups.xlsx", sheet = "tabla")
# tabla
abo %>% 
  kbl(caption = "Tabla 1. Distribución de probabilidades (a partir de frecuencias) de los tipos de sangre ABO, en cuatro grupos étnicos de los Estados Unidos.") %>%
  kable_classic(full_width = F, html_font =
                  "Cambria")
```

```{r barras, message=FALSE, warning=FALSE}
library(ggplot2)
# datos
abog <- read_excel("data/ABOtypes-ethnic-groups.xlsx", sheet = "barras")
# gráfica de barras por grupo étnico
ggplot(abog, aes(x=Ethnic_Group, y = Probability,
                 fill=Blood_Type)) +
     geom_col(position="fill")
```

__Figura 1__ Distribución de probabilidades (a partir de frecuencias) de los tipos de sangre ABO, en cuatro grupos étnicos de los Estados Unidos.  

\

[  __Home__](https://dsfernandez.github.io/bioestadisticas/index.html)

## 1.5.2.Número de Posibilidades
#### Objetivos
__Contabilizar todos los posibles resultados y eventos de un experimento o prueba__  
La definición de probabilidad requiere conocer el número total de eventos posibles, para poder calcular la misma.  En esta sección trataremos algunas maneras de cómo podemos contar los posibles resultados de experimentos o pruebas.  

### Secuencia de repeticiones  
Cuando es importante la secuencia en los resultados de repeticiones podemos aplicar una función de potencia para encontrar el  número total de eventos posibles:
$$eventos = (resultados\ posibles)^{número-repeticiones}$$  
Al tirar un dado existen 6 resultados posibles, y los eventos diferentes que podemos observar son $6^1 = 6$; si tiramos el dado dos veces podemos calcular el total de números diferentes de dos dígitos que se formarán: $6^2 = 36$.  

#### __Ejemplo__

_¿Por qué son necesarios codones de tres nucleótidos para codificar un aminoácido?_  
Para la síntesis de proteínas a partir de un RNA mensajero, se necesitan RNAs de transferencia que posean codones específicos (secuencias de tres de los cuatro nucleótidos - U, C, A, G)  para 20 aminoácidos.  

![](./imagenes/aa-codon-mrna.png)  
__Figura 1.__ Esquema de la síntesis de una proteína a partir de un mRNA y codones con sus respectivos aminoácidos.  Hay también codones de inicio y parada de la síntesis.  (tomada de Khan Academy, khanacademy.org)  

Aplicando la fórmula de potencia podemos calcular cuantas secuencias (eventos) podemos producir tomando de 1 a n nucleótidos:
$$4^1 = 4$$  
$$4^2 = 16$$  
$$4^3 = 64$$  
$$4^4 = 256$$  
Codones de dos nucleótidos no producen suficientes secuencias diferentes para los 20 aminoácidos, inicio y paradas.  Codones de tres aminoácidos producen 64 diferentes secuencias, suficiente para los 20 aminoácidos, y le provee redundancia al sistema.  

#### __Ejercicio__

¿Cuántos números (eventos) son posibles en la lotería de 5 números?   

### Permutaciones  

En el caso de las secuencias, los elementos disponibles  para cada repetición son ilimitados, ahora consideremos el caso cuando estos elementos son limitados, si ocurre uno, no vuelve a ocurrir.  En este caso los resultados son permutaciones _(P)_ de los _n_ elementos, y se calculan:
$$_nP_n = n!$$  
Si no usamos todos los _n_ elementos al mismo tiempo, sino un subconjunto de _X_ elementos, entonces la fórmula es:  
$$_nP_X = \frac{n!}{(n - X)!}$$

#### __Ejemplo__  

Si tenemos las siguientes letras: m, x, y, z, p, t, l, k, calcular cuántos códigos de ocho letras podemos crear con ellas, sin que se repitan las letras; también vamos a calcular cuántos códigos de cuatro letras podemos crear:

```{r permutaciones}
# con n letras
n <- 8
Pn <- factorial(n)
# con X letras
X <- 4
PX <- factorial(n) / factorial(n - X)
# resultados
sprintf("%s = %i", "códigos de 8 letras", Pn)
sprintf("%s = %i", "códigos de 4 letras", PX)
```

### Combinaciones  

Podemos contar los posibles resultados en cuanto a grupos de objetos tomados todos o parcialmente, sin que nos importe la secuencia en que ocurran en cada grupo, y en este caso estamos contando combinaciones:  
$$_nC_X = \frac{n!}{X!(n - X)!}$$  

Usaremos el ejemplo anterior para contar el número de combinaciones de ocho y cuatro letras:  
```{r combinaciones}
# con n letras
n <- 8 # X = n
Cn <- factorial(n)/(factorial(n) * factorial(n - n))
# con X letras
X <- 4
CX <- factorial(n) /(factorial(X) * factorial(n - X))
# resultados
sprintf("%s = %i", "códigos de 8 letras", Cn)
sprintf("%s = %i", "códigos de 4 letras", CX)
```  

\

[  __Home__](https://dsfernandez.github.io/bioestadisticas/index.html)

## 1.5.3.Independencia y Probabilidad Condicional  
#### Objetivos  
__Distinguir las probabilidades de eventos independientes y eventos no independientes__  

### Probabilidad de eventos independientes  

Dos eventos son independientes cuando la ocurrencia de uno, no afecta la ocurrencia del otro.  El ejemplo clásico es el lanzamiento varias veces de una modeda, en cada lanzamiento la probabilidad de obtener cara o cruz es la misma: 1/2 (0.5).  Ahora bien, si para cada lanzamiento esperamos un evento en particular, digamos que el primer lanzamiento sea cara y el segundo sea cara también, en este caso se aplica la __Regla de la Multiplicación__, es decir, esperamos que el evento A ocurra con un resultado y que el evento B ocurra también con un resultado esperado:  
$$p(A\ y\ B) = p(A)\ *\ p(B)$$  

#### __Ejemplo__  
Una aplicación de esta regla en la biología, la encontramos cuando calculamos la probabilidad de un tipo particular de genotipo.  Por ejemplo, si queremos calcular la probabilidad de un genotipo recesivo, a partir de padres heterocigotos, asumiendo igual segregación de los alelos, la probabilidad del genotipo recesivo será: 1/2 x 1/2 = 1/4 (0.25).  

### Probabilidad condicional  
Si dos eventos no son independientes, la probabilidad conjunta es una __condicional__, donde la probabilidad del segundo evento, está ligada a la probabilidad de la ocurrencia del primero.  En este caso se aplica la __Regla General de la Multiplicación__:  
$$p(A\ y\ B) = p(A)\ *\ p(B|A)$$  
que se lee: la probabilidad de la ocurrencia secuencial de los eventos A y B, es la probabilidad del evento A, multiplicada por la probabilidad del evento B cuando ocurre el evento A.  

#### __Ejemplo__  
En una universidad hay 12242, de las cuales 6027 se identifican como mujeres; la universidad tiene 5000 estudiantes graduados, de las cuales 2213 se identifican como mujeres.  ¿Cuál es la probabilidad de seleccionar de la lista de estudiantes a una estudiante, y que además sea estudiante graduada?  
Aplicando la regla general de la multiplicación:  
$$P(M\ y\ G) = P(M)\ *\ P(G|M)$$  
6027/12242 = 0.49 y 2213/5000 = 0.44  
$$P(M\ y\ G) = 0.49*0.44 = 0.22$$



[  __Home__](https://dsfernandez.github.io/bioestadisticas/index.html)

## 1.5.4.Eventos Mutuamente Exclusivos  
#### Objetivos  
__Calcular probabilidades de eventos mutuamente exclusivos total o parcialmente__  

En algunas situaciones deseamos conocer la probabilidad de que ocurran al menos dos o más eventos específicos excluyentes en una prueba; es decir ¿cuál es la probabilidad de que ocurra el evento A o el B (no ambos) en una prueba.  En este caso se aplica la __Regla de Adición Simple__:  
$$P(A\ o\ B) = P(A) + P(B)$$  

#### __Ejemplo__   
¿Cuál es la probabilidad de que un dado muestre un 3 o un 7 en una tirada?
P(3) = 1/6 y P(7) = 1/6, por lo tanto la probabilidad P(3 o 7) = 1/6 + 1/6 = 1/3.  

### Exclusión incompleta  
En el campo de la biología es frecuente la ocurrencia de eventos de forma exclusiva en algunos casos, pero en otros de manera concurrente.  En estos casos, la probabilidad de ocurrencia de un evento u otro, tomando en cuenta la concurrencia se calcula con la __Regla General de la Adición__:  
$$P(A\ o\ B) = P(A) + P(B) - P(A\ y\ B)$$  
podemos que cuando hay exclusión mutua completa, P(A y B) será igual a 0.  

#### __Ejemplo__
Ciertas condiciones de salud pueden estar presentes de manera excluyente (si ocurre una no ocurre la otra), o pueden ocurrir ambas simultáneamente.  Un ejemplo es la alta presión sanguínea y altos niveles de colesterol en la sangre.  Una forma de representar las probabilidades de estos eventos, es mediante lo que se conoce como diagramas de Venn.  

![](./imagenes/5-5 Venn Diagram AB.jpg)  

__Figura 2.__  Diagrama de Venn de los conjuntos de probabilidades de los eventos alta presión sanguínea, altos niveles de colesterol en la sangre, y la probabilidad concurrente de ambas condiciones.  

\

[  __Home__](https://dsfernandez.github.io/bioestadisticas/index.html)

## 1.5.5.Distribución Binomial y de Poisson  
#### Objetivos  
__



[  __Home__](https://dsfernandez.github.io/bioestadisticas/index.html)

